<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Probabilistische Datenwissenschaft für die Psychologie - 39&nbsp; Kanonische Korrelationsanalyse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Referenzen.html" rel="next">
<link href="./503-Einfaktorielle-Varianzanalyse.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Probabilistische Datenwissenschaft für die Psychologie</span>
    </a>
  </div>
        <div class="quarto-navbar-tools">
    <a href="https://github.com/dirk-ostwald/dirk-ostwald.github.io/tree/gh-pages" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <a href="./Probabilistische-Datenwissenschaft-für-die-Psychologie.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
          <div id="quarto-search" class="" title="Suchen"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./501-Datendeskription.html">Multivariate Inferenz</a></li><li class="breadcrumb-item"><a href="./504-Kanonische-Korrelationsanalyse.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Kanonische Korrelationsanalyse</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./100-Mathematische-Grundlagen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mathematische Grundlagen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./101-Sprache-und-Logik.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Sprache und Logik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./102-Mengen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Mengen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./103-Summen-Produkte-Potenzen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Summen, Produkte, Potenzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./104-Funktionen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Funktionen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./105-Differentialrechnung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Differentialrechnung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./106-Folgen-Grenzwerte-Stetigkeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Folgen, Grenzwerte, Stetigkeit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./107-Integralrechnung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Integralrechnung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./108-Vektoren.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Vektoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./109-Matrizen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Matrizen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./110-Eigenanalyse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Eigenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">200-Wahrscheinlichkeitstheorie.qmd</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./201-Wahrscheinlichkeitsräume.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Wahrscheinlichkeitsräume</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./202-Elementare-Wahrscheinlichkeiten.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Elementare Wahrscheinlichkeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./203-Zufallsvariablen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Zufallsvariablen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./204-Zufallsvektoren.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Zufallsvektoren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./205-Erwartungswerte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Erwartungswerte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./206-Ungleichungen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Ungleichungen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./207-Grenzwerte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Grenzwerte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./208-Transformationstheoreme.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformationstheoreme</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./209-Normalverteilungstransformationen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Normalverteilungstransformationen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./210-Multivariate-Normalverteilungen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Multivariate Normalverteilungen</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Frequentistische Inferenz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./301-Grundbegriffe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Grundbegriffe</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./302-Punktschätzung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Punktschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./303-Konfidenzintervalle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Konfidenzintervalle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./304-Hypothesentests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Hypothesentests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Das Allgemeine Lineare Modell</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./401-Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./402-Korrelation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./403-Modellformulierung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modellformulierung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./404-Parameterschätzung.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Parameterschätzung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./405-T-Statistiken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">T-Statistiken</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./406-F-Statistiken.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">F-Statistiken</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./407-T-Tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">T-Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./408-Einfaktorielle-Varianzanalyse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Einfaktorielle Varianzanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./409-Zweifaktorielle-Varianzanalyse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Zweifaktorielle Varianzanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./410-Partielle-Korrelation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Partielle Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./411-Multiple-Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Multivariate Inferenz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./501-Datendeskription.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Datendeskription</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./502-Einstichproben-T2-Tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Einstichproben-T<span class="math inline">\(^2\)</span>-Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./503-Einfaktorielle-Varianzanalyse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Einfaktorielle Varianzanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./504-Kanonische-Korrelationsanalyse.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Kanonische Korrelationsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Referenzen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referenzen</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#sec-anwendungsszenario" id="toc-sec-anwendungsszenario" class="nav-link active" data-scroll-target="#sec-anwendungsszenario"><span class="header-section-number">39.1</span> Anwendungsszenario und Grundzüge</a>
  <ul class="collapse">
  <li><a href="#anwendungsbeispiel" id="toc-anwendungsbeispiel" class="nav-link" data-scroll-target="#anwendungsbeispiel">Anwendungsbeispiel</a></li>
  </ul></li>
  <li><a href="#sec-mathematischer-hintergrund" id="toc-sec-mathematischer-hintergrund" class="nav-link" data-scroll-target="#sec-mathematischer-hintergrund"><span class="header-section-number">39.2</span> Mathematischer Hintergrund</a></li>
  <li><a href="#sec-modellformulierung-kka" id="toc-sec-modellformulierung-kka" class="nav-link" data-scroll-target="#sec-modellformulierung-kka"><span class="header-section-number">39.3</span> Modellformulierung</a>
  <ul class="collapse">
  <li><a href="#simulationsbeispiel" id="toc-simulationsbeispiel" class="nav-link" data-scroll-target="#simulationsbeispiel">Simulationsbeispiel</a></li>
  </ul></li>
  <li><a href="#sec-modellschaetzung-kka" id="toc-sec-modellschaetzung-kka" class="nav-link" data-scroll-target="#sec-modellschaetzung-kka"><span class="header-section-number">39.4</span> Modellschätzung</a>
  <ul class="collapse">
  <li><a href="#simulationsbeispiel-1" id="toc-simulationsbeispiel-1" class="nav-link" data-scroll-target="#simulationsbeispiel-1">Simulationsbeispiel</a></li>
  </ul></li>
  <li><a href="#sec-anwendungsbeispiel-kka" id="toc-sec-anwendungsbeispiel-kka" class="nav-link" data-scroll-target="#sec-anwendungsbeispiel-kka"><span class="header-section-number">39.5</span> Anwendungsbeispiel</a></li>
  <li><a href="#literaturhinweise" id="toc-literaturhinweise" class="nav-link" data-scroll-target="#literaturhinweise"><span class="header-section-number">39.6</span> Literaturhinweise</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/dirk-ostwald/dirk-ostwald.github.io/tree/gh-pages/edit/main/504-Kanonische-Korrelationsanalyse.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./501-Datendeskription.html">Multivariate Inferenz</a></li><li class="breadcrumb-item"><a href="./504-Kanonische-Korrelationsanalyse.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Kanonische Korrelationsanalyse</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-kanonische-korrelationsanalyse" class="quarto-section-identifier"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Kanonische Korrelationsanalyse</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-anwendungsszenario" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="sec-anwendungsszenario"><span class="header-section-number">39.1</span> Anwendungsszenario und Grundzüge</h2>
<p>Ausgangspunkt einer kanonischen Korrelationsanalyse ist die exploratorische Frage nach der Stärke des Zusammenhangs einer multivariaten unabhängigen Variablen <span class="math inline">\(x\)</span> und einer multivariaten abhängigen Variable <span class="math inline">\(y\)</span>. Im Kontext der kanonischen Korrelationsanalyse werden diese Variablen auch oft als <em>Prädiktoren</em> und <em>Kriterien</em>, respektive, bezeichnet. Dabei werden vorliegende Daten von sowohl der Prädiktoren als auch der Kriterien als Realisierungen von unabhängig und identisch verteilten <span class="math inline">\(m_x\)</span>- bzw. <span class="math inline">\(m_y\)</span>-dimensionalen Zufallsvektoren betrachtet. Um die Frage nach der Stärke des Zusammenhangs von Prädiktoren und Kriterien zu beantworten, betrachtet die kanonische Korrelationsanalyse Linearkombinationen der Komponenten der Prädiktoren und Kriterien. Wir bezeichnen die Linearkombinationen von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> mit Parametervektoren <span class="math inline">\(a \in \mathbb{R}^{m_x}\)</span> und <span class="math inline">\(b \in \mathbb{R}^{m_y}\)</span> im Folgenden mit <span class="math display">\[\begin{equation}
\xi  := a^Tx  
\mbox{ und }
\upsilon := b^Ty  
\end{equation}\]</span> <span class="math inline">\(\xi\)</span> und <span class="math inline">\(\upsilon\)</span> sind dann als Linearkombinationen von Zufallsvariablen selbst Zufallsvariablen, deren Korrelation <span class="math inline">\(\rho(\xi,\upsilon)\)</span> berechnet werden kann. Die kanonische Korrelationsanalyse bestimmt dann die Parametervektoren <span class="math inline">\(a\)</span> und <span class="math inline">\(b\)</span> so, dass die Korrelation von <span class="math inline">\(\xi\)</span> und <span class="math inline">\(\upsilon\)</span> so groß wie möglich wird. Ist eine solche Parametervektorkombination und ihre entsprechende Korrelation, die dann als kanonische Korrelation bezeichnet gefunden, so kann <span class="math inline">\(\xi\)</span> als bester Prädiktor und <span class="math inline">\(\upsilon\)</span> als “am besten prädizierbares Kriterium” interpretiert werden.</p>
<p>Für Skalare <span class="math inline">\(\alpha\)</span> und <span class="math inline">\(\beta\)</span> sind die Korrelationen <span class="math inline">\(\rho(\xi,\upsilon)\)</span> und <span class="math inline">\(\rho(\alpha\xi,\beta\upsilon)\)</span> allerdings, wie im Theorem zu Kovarianz und Korrelation bei linear-affinen Transformationen gezeigt, identisch. Die kanonische Korrelationsanalyse sucht deshalb speziell Parametervektoren <span class="math inline">\(a\)</span> und <span class="math inline">\(b\)</span>, für die <span class="math inline">\(\rho(\xi,\upsilon)\)</span> einerseits maximal ist und für die <span class="math inline">\(\xi\)</span> und <span class="math inline">\(\upsilon\)</span> gleichzeitig jeweils eine standardisierte Varianz von 1 haben. Da aufgrund des Theorem zu Kovarianz und Korrelation bei linear-affinen Transformationen die Varianzen zu verschiedenen skalaren Vielfachen von <span class="math inline">\(\xi\)</span> und <span class="math inline">\(\upsilon\)</span> verschieden sind, legt diese die Parametervektorwerte <span class="math inline">\(a\)</span> und <span class="math inline">\(b\)</span>, für die <span class="math inline">\(\rho(\xi,\upsilon)\)</span> maximal ist, eindeutig fest. Zur Bestimmung einer kanonischen Korrelation und der Parametervektoren von <span class="math inline">\(a\)</span> und <span class="math inline">\(b\)</span> ist man also auf ein Optimierungsproblem mit Nebenbedingungen geführt.</p>
<p>In unser Darstellung kanonischen Korrelationsanalyse folgen wir <span class="citation" data-cites="mardia1979">Mardia et al. (<a href="#ref-mardia1979" role="doc-biblioref">1979</a>)</span>. Dabei werden die Prädiktor- und Kriterienzufallsvektoren <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> in einem Zufallsvektor <span class="math display">\[\begin{equation}
z := \begin{pmatrix} x \\ y \end{pmatrix}
\end{equation}\]</span> zusammengefasst, für den wir durchgängig annehmen wollen, dass <span class="math inline">\(\mathbb{E}(z) = 0_{m}\)</span> mit <span class="math inline">\(m = m_x + m_y\)</span> gilt. Im Anwendungskontext entspricht dies der Annahme, dass vor Durchführung der kanonischen Korrelationsanalyse die Stichprobenmittel des Stichprobenmittels von den beobachteten Daten vor Durchführung der kanonischen Korrelationsanalyse subtrahiert werden. Da, wie wir sehen werden, die Schätzung der kanonischen Korrelation allerdings lediglich auf den Stichprobenkovarianzmatrizen beruht ist dieser Schritt verzichtbar.</p>
<p>Der mathematische Fokus der Entwicklung der kanonischen Korrelationsanalyse nach <span class="citation" data-cites="mardia1979">Mardia et al. (<a href="#ref-mardia1979" role="doc-biblioref">1979</a>)</span> liegt damit auf der Kovarianzmatrix <span class="math inline">\(\mathbb{C}(z)\)</span>. Speziell ergeben sich die Kovarianzen von Linearkombinationen von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> aus Matrixprodukten von <span class="math inline">\(\mathbb{C}(z)\)</span> und es können einige Matrixtheoreme, die in <a href="204-Zufallsvektoren.html" class="quarto-xref"><span>Kapitel 14</span></a> und <a href="110-Eigenanalyse.html" class="quarto-xref"><span>Kapitel 10</span></a> dokumentiert sind angewendet werden. Generell wird in der Entwicklung nach <span class="citation" data-cites="mardia1979">Mardia et al. (<a href="#ref-mardia1979" role="doc-biblioref">1979</a>)</span> ein Optimierungsansatz mithilfe von Lagrangefunktionen, wie in den Originalarbeiten von <span class="citation" data-cites="hotelling1935">Hotelling (<a href="#ref-hotelling1935" role="doc-biblioref">1935</a>)</span> und <span class="citation" data-cites="hotelling1936">Hotelling (<a href="#ref-hotelling1936" role="doc-biblioref">1936</a>)</span> gewählt, zugunsten der Eigenanalyse von Matrixprodukten supprimiert. Für die Entwicklung mit einem Lagrangeansatz verweisen wir auf zum Beispiel <span class="citation" data-cites="anderson2003">Anderson (<a href="#ref-anderson2003" role="doc-biblioref">2003</a>)</span>.</p>
<p>Im Folgenden diskutieren wir in <a href="#sec-mathematischer-hintergrund" class="quarto-xref"><span>Kapitel 39.2</span></a> zunächst zwei Theoreme, die direkt durch die kanonische Korrelationsanalyse motiviert sind und die, zusammen mit den oben erwähnten Theoremen in <a href="204-Zufallsvektoren.html" class="quarto-xref"><span>Kapitel 14</span></a> und <a href="110-Eigenanalyse.html" class="quarto-xref"><span>Kapitel 10</span></a> das analytische und probabilistische Fundament der kanonischen Korrelationsanalyse bilden. In <a href="#sec-modellformulierung-kka" class="quarto-xref"><span>Kapitel 39.3</span></a> führen wir mit den <em>kanonischen Korrelationen</em>, den <em>kanonischen Variaten</em> und den <em>kanonischen Koeffizientenvektoren</em> dann die zentralen Begriffe der kanonischen Korrelationsanalyse ein. In <a href="#sec-modellschaetzung-kka" class="quarto-xref"><span>Kapitel 39.4</span></a> diskutieren wir dann, wie diese Größen auf Basis der Stichprobenkovarianzmatrix eines Datensatzes von Prädiktoren- und Kriterienrealisierungen geschätzt werden können. In <a href="#sec-anwendungsbeispiel-kka" class="quarto-xref"><span>Kapitel 39.5</span></a> schließlich wenden wir die kanonische Korrelationsanalyse auf das unten skizzierte Anwendungsbeispiel an.</p>
<section id="anwendungsbeispiel" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="anwendungsbeispiel">Anwendungsbeispiel</h3>
<p>Als konkretes Anwendungsbeispiel für eine kanonische Korrelationanalyse betrachten wir einen simulierten Datensatz zur Effektivität einer Psychotherapie bei Depressionen. Dabei seien pro Patient:in vier Variablen verfügbar: Zum einen als Maße für die Therapiequalität die Dauer der Psychotherapie (<code>DUR</code>) und die klinische Erfahrung der behandelnden Psychotherapeut:in (<code>EXP</code>); zum anderen als Maße für die Reduktion der Depressionssymptomatik sowohl BDI Score und Glukokortikoidplasmalevel Differenzwerte zwischen Beginn und Ende der Therapie (<code>dBDI</code> und <code>dGLU</code>), wobei positive Werte eine Verringerung der Depressionssymptomatik anzeigen sollen. Wir stellen uns vor, dass man im Sinne einer exploratorischen Analyse daran interessiert ist, inwieweit die Variablen <code>DUR</code> (<span class="math inline">\(x_1\)</span>) und <code>EXP</code> (<span class="math inline">\(x_2\)</span>) als Prädiktoren (unabhängige Variablen) mit den Variablen <code>dBDI</code> (<span class="math inline">\(y_1\)</span>) und <code>dGLU</code> (<span class="math inline">\(y_2\)</span>) als Kriterien (abhängige Variablen) zusammenhängen. Im Sinne obiger Bezeichner gilt hier also <span class="math inline">\(m_x = m_y = 2\)</span>. <a href="#tbl-beispieldatensatz" class="quarto-xref">Tabelle&nbsp;<span>39.1</span></a> zeigt dazu einen Beispieldatensatz für <span class="math inline">\(n = 20\)</span> Patient:innen.</p>
<div class="cell">
<div id="tbl-beispieldatensatz" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beispieldatensatz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.1: Beispielhafte Prädiktoren- und Kriterienrealisierungen im Kontext der Psychotherapie bei Depressionen
</figcaption>
<div aria-describedby="tbl-beispieldatensatz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">DUR</th>
<th style="text-align: center;">EXP</th>
<th style="text-align: center;">dBDI</th>
<th style="text-align: center;">dGLU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">27.9</td>
<td style="text-align: center;">7.8</td>
<td style="text-align: center;">35.5</td>
<td style="text-align: center;">6.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">15.3</td>
<td style="text-align: center;">9.3</td>
<td style="text-align: center;">25.0</td>
<td style="text-align: center;">4.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">17.4</td>
<td style="text-align: center;">2.1</td>
<td style="text-align: center;">19.7</td>
<td style="text-align: center;">1.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">21.5</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">28.8</td>
<td style="text-align: center;">2.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">28.2</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">29.4</td>
<td style="text-align: center;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">14.0</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">17.2</td>
<td style="text-align: center;">0.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">28.0</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">32.9</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">28.9</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">28.3</td>
<td style="text-align: center;">4.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">23.2</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">25.8</td>
<td style="text-align: center;">3.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">22.6</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">31.3</td>
<td style="text-align: center;">3.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11.2</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">14.4</td>
<td style="text-align: center;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">14.1</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">18.4</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">13.5</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">19.1</td>
<td style="text-align: center;">5.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">23.7</td>
<td style="text-align: center;">4.9</td>
<td style="text-align: center;">28.0</td>
<td style="text-align: center;">2.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">17.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">20.3</td>
<td style="text-align: center;">2.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">25.4</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">34.8</td>
<td style="text-align: center;">4.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20.0</td>
<td style="text-align: center;">6.7</td>
<td style="text-align: center;">27.6</td>
<td style="text-align: center;">4.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">24.4</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">31.9</td>
<td style="text-align: center;">3.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">29.8</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">32.2</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">17.6</td>
<td style="text-align: center;">7.2</td>
<td style="text-align: center;">24.6</td>
<td style="text-align: center;">1.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="sec-mathematischer-hintergrund" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="sec-mathematischer-hintergrund"><span class="header-section-number">39.2</span> Mathematischer Hintergrund</h2>
<p>Folgendes Theorem bildet das analytische Fundament der kanonischen Korrelationsanalyse.</p>
<div id="thm-maximierung-quadratischer-formen-mit-nebenbedingungen" class="theorem">
<p><span class="theorem-title"><strong>Theorem 39.1 (Maximierung quadratischer Formen mit Nebenbedingungen)</strong></span> <span class="math inline">\(A \in \mathbb{R}^{m \times m}, B \in \mathbb{R}^{m \times m}\)</span> pd seien symmetrische Matrizen und <span class="math inline">\(\lambda_1\)</span> sei der größte Eigenwert von <span class="math inline">\(B^{-1}A\)</span> mit assoziertem Eigenvektor <span class="math inline">\(v_1 \in \mathbb{R}^m\)</span>. Dann ist <span class="math inline">\(\lambda_1\)</span> eine Lösung des Optimierungsproblems <span class="math display">\[\begin{equation}\label{eq:opt_1}
\max_{x} x^TAx \mbox{ unter der Nebenbedingung } x^TBx = 1.
\end{equation}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Beweis</em>. </span><span class="math inline">\(B^{1/2}\)</span> sei die symmetrische Quadratwurzel von <span class="math inline">\(B\)</span> und es sei <span class="math display">\[\begin{equation}
y := B^{1/2}x \Leftrightarrow x = B^{-1/2}y
\end{equation}\]</span> Dann kann mit der symmetrischen Matrix <span class="math display">\[\begin{equation}
K := B^{-1/2}AB^{-1/2} \in \mathbb{R}^{m \times m}
\end{equation}\]</span> das Optimierungsproblem <span class="math inline">\(\eqref{eq:opt_1}\)</span> geschrieben werden als <span class="math display">\[\begin{equation}\label{eq:opt_2}
\max_{y} y^T K y
\mbox{ unter der Nebenbedingung }
y^Ty = 1.
\end{equation}\]</span> Dies gilt, weil <span class="math display">\[\begin{equation}
\max_{x} x^TAx
\Leftrightarrow
\max_{y} \left(B^{-1/2}y\right)^TA\left(B^{-1/2}y\right)
\Leftrightarrow
\max_{y} y^TB^{-1/2}AB^{-1/2}y
\Leftrightarrow
\max_{y} y^TKy
\end{equation}\]</span> und <span class="math display">\[\begin{equation}
x^TBx = 1
\Leftrightarrow y^T B^{-1/2}BB^{-1/2}y = 1
\Leftrightarrow y^Ty = 1.
\end{equation}\]</span> Weil <span class="math inline">\(K\)</span> eine symmetrische Matrix ist, existiert die Orthonormalzerlegung (vgl. <a href="110-Eigenanalyse.html" class="quarto-xref"><span>Kapitel 10</span></a>) <span class="math display">\[\begin{equation}
K = Q\Lambda Q^T,
\end{equation}\]</span> wobei die Spalten der orthogonalen Matrix <span class="math inline">\(Q\)</span> die Eigenvektoren von <span class="math inline">\(K\)</span> und die Diagonalemente von <span class="math inline">\(\Lambda\)</span> die zugehörigen Eigenwerte von <span class="math inline">\(K\)</span> sind. Mit der orthogonalen Matrix <span class="math inline">\(Q\)</span> aus obiger Orthornomalzerlegung sei nun <span class="math display">\[\begin{equation}
z := Q^Ty \Leftrightarrow y := Qz.
\end{equation}\]</span> Dann kann das Optimierungsproblem <span class="math inline">\(\eqref{eq:opt_2}\)</span> geschrieben werden als <span class="math display">\[\begin{equation}\label{eq:opt_3}
\max_{z} \sum_{i = 1}^m \lambda_i z_i^2 \mbox{ unter der Nebenbedingung } z^Tz = 1,
\end{equation}\]</span> weil <span class="math display">\[\begin{equation}
\max_{y} y^TKy
\Leftrightarrow
\max_{z} (Qz)^TK(Qz)
\Leftrightarrow
\max_{z} z^TQ^TQ\Lambda Q^TQz
\Leftrightarrow
\max_{z} z^T\Lambda z
\Leftrightarrow
\max_{z} \sum_{i=1}^m \lambda_i z_i^2
\end{equation}\]</span> und <span class="math display">\[\begin{equation}
y^Ty = 1
\Leftrightarrow
(Qz)^T Qz = 1
\Leftrightarrow
z^T Q^TQz = 1
\Leftrightarrow
z^T z = 1.
\end{equation}\]</span> Die Eigenwerte von <span class="math inline">\(K\)</span> seien nun absteigend sortiert, also <span class="math inline">\(\lambda_1 \ge \cdots \ge \lambda_m\)</span>. Dann gilt für das Optimierungsproblem <span class="math inline">\(\eqref{eq:opt_3}\)</span>, dass <span class="math display">\[\begin{equation}
\max_{z} \sum_{i = 1}^m \lambda_i z_i^2 \le \lambda_1,
\end{equation}\]</span> weil <span class="math display">\[\begin{equation}
\max_{z} \sum_{i = 1}^m \lambda_i z_i^2
\le
\max_{z} \sum_{i = 1}^m \lambda_1 z_i^2
=
\lambda_1 \max_{z} \sum_{i = 1}^m z_i^2
=
\lambda_1
\end{equation}\]</span> wobei sich die letzte Gleichung aus der Nebenbedingung <span class="math inline">\(z^Tz=1\)</span> ergibt. Schließlich gilt <span class="math display">\[\begin{equation}
\max_{z} \sum_{i = 1}^m \lambda_i z_i^2  = \lambda_1,
\end{equation}\]</span> für <span class="math inline">\(z := e_1 = (1,0,...,0)^T\)</span>. Zusammenfassend heißt das, dass <span class="math inline">\(z = e_1\)</span> eine Lösung des Optimierungsproblem <span class="math inline">\(\eqref{eq:opt_3}\)</span> ist und das <span class="math inline">\(\lambda_1\)</span> das entsprechende Maximum ist. Damit ergibt sich aber sofort, dass dann <span class="math display">\[\begin{equation}
y = Qz = Qe_1 =  q_1 \mbox{ und } x = B^{-1/2}q_1
\end{equation}\]</span> Lösungen der äquivalenten Optimierungsprobleme <span class="math inline">\(\eqref{eq:opt_2}\)</span> und <span class="math inline">\(\eqref{eq:opt_1}\)</span>, respektive, sind. Nach Konstruktion ist <span class="math inline">\(q_1\)</span> ein Eigenvektor von <span class="math inline">\(B^{-1/2}AB^{-1/2}\)</span> und nach obigem Theorem zu Eigenwerten und Eigenvektoren von Matrixprodukten damit auch ein Eigenvektor von <span class="math display">\[\begin{equation}
B^{-1/2}B^{-1/2}A = B^{-1}A
\end{equation}\]</span> und die zugehörigen Eigenwerte sind gleich. Damit aber folgt, dass der größte Eigenwert von <span class="math inline">\(B^{-1}A\)</span> und sein assoziierter Eigenvektor eine Lösung von <span class="math display">\[\begin{equation}
\max_{x} x^TAx \mbox{ unter der Nebenbedingung } x^TBx = 1.
\end{equation}\]</span> ist.</p>
</div>
<p>Nach Wortlaut des Theorems gilt also für die Funktion <span class="math display">\[\begin{equation}
f : \mathbb{R}^m \to \mathbb{R}, x \mapsto f(x) := x^TAx,
\end{equation}\]</span> dass <span class="math display">\[\begin{equation}
v_1 = \mbox{argmax}_{x} x^TAx \mbox{ unter der Nebenbedingung } x^TBx = 1
\end{equation}\]</span> und dass <span class="math display">\[\begin{equation}
\lambda_1 = \mbox{max}_{x} x^TAx \mbox{ unter der Nebenbedingung } x^TBx = 1.
\end{equation}\]</span></p>
<p>Das folgende Theorem setzt die für die kanonischen Korrelationsanalyse zentralen Größen der Varianzen von Linearkombinationen von Zufallsvektoren und der Korrelation von Linearkombinationen von Zufallsvektoren in Bezug zur Kovarianzmatrix der gemeinsamen Verteilung der Zufallsvektoren und bildet das probabilistische Fundament der kanonischen Korrelationsanalyse.</p>
<div id="thm-linearkombinationen-von-zufallsvektorpartitionen" class="theorem">
<p><span class="theorem-title"><strong>Theorem 39.2 (Linearkombinationen von Zufallsvektorpartitionen)</strong></span> &nbsp;</p>
Es sei <span class="math display">\[\begin{equation}
z = \begin{pmatrix} x \\ y \end{pmatrix}
\mbox{ mit }
\mathbb{E}(z) = 0_m
\mbox{ und }
\mathbb{C}(z) =
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy} \\
\end{pmatrix}
\end{equation}\]</span> ein <span class="math inline">\(m\)</span>-dimensionaler partitionierter Zufallsvektor sowie sein Erwartungswertvektor und seine Kovarianzmatrix, respektive. Weiterhin seien für <span class="math inline">\(a \in \mathbb{R}^{m_x}\)</span> und <span class="math inline">\(b\in\mathbb{R}^{m_y}\)</span> die Zufallsvariablen <span class="math display">\[\begin{equation}
\xi := a^T x \mbox{ und } \upsilon := b^T y
\end{equation}\]</span> als Linearkombinationen der Komponenten von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> definiert. Dann gelten
</div>
<div class="proof">
<p><span class="proof-title"><em>Beweis</em>. </span>Wir betrachten zunächst die Varianz von <span class="math inline">\(\xi\)</span>. Mit dem Varianzverschiebungssatz gilt <span class="math display">\[\begin{align}
\begin{split}
\mathbb{V}(\xi)
&amp; = \mathbb{E}\left(\xi \xi \right) - \mathbb{E}(\xi)\mathbb{E}(\xi) \\
&amp; = \mathbb{E}\left((a^Tx) (a^Tx)\right) - \mathbb{E}\left(a^Tx\right)\mathbb{E}\left(a^Tx\right) \\
&amp; = \mathbb{E}\left((a^Tx) (a^Tx)^T\right) - \mathbb{E}\left(a^Tx\right)\mathbb{E}\left(a^Tx\right) \\
&amp; = \mathbb{E}\left(a^Txx^Ta\right) - \mathbb{E}\left(a^Tx\right)\mathbb{E}\left(a^Tx\right) \\
&amp; = a^T\mathbb{E}\left(xx^T\right)a - a^T\mathbb{E}(x)a^T\mathbb{E}(x) \\
&amp; = a^T\mathbb{E}\left(xx^T\right)a - a^T0_{m_x}a^T0_{m_x} \\
&amp; = a^T\Sigma_{xx}a. \\
\end{split}
\end{align}\]</span> Der Beweis zur Varianz von <span class="math inline">\(\upsilon\)</span> folgt dann analog. Mit der Definition der Korrelation von Zufallsvariablen und mit <span class="math inline">\(\mathbb{V}(\xi) = \mathbb{V}(\upsilon) = 1\)</span> und dem Kovarianzverschiebungssatz gilt <span class="math display">\[\begin{align}
\begin{split}
\rho(\xi,\upsilon)
&amp; = \frac{\mathbb{C}(\xi,\upsilon)}{\sqrt{\mathbb{V}(\xi)}\sqrt{\mathbb{V}(\upsilon)}} \\
&amp; = \frac{\mathbb{C}(\xi,\upsilon)}{\sqrt{1}\sqrt{1}} \\
&amp; = \mathbb{C}(\xi,\upsilon) \\
&amp; = \mathbb{E}(\xi\upsilon) - \mathbb{E}(\xi)\mathbb{E}(\upsilon) \\
&amp; = \mathbb{E}\left((a^Tx)(b^Ty)\right) - \mathbb{E}(a^Tx)\mathbb{E}(b^Ty) \\
&amp; = \mathbb{E}\left((a^Tx)(b^Ty)^T\right) - \mathbb{E}(a^Tx)\mathbb{E}(b^Ty) \\
&amp; = \mathbb{E}\left(a^T xy^Tb \right) - \mathbb{E}(a^Tx)\mathbb{E}(b^Ty) \\
&amp; = a^T\mathbb{E}\left(xy^T \right)b - a^T\mathbb{E}(x)b^T\mathbb{E}(y) \\
&amp; = a^T\mathbb{E}\left(xy^T \right)b - a^T0_{m_x}b^T0_{m_y} \\
&amp; = a^T\Sigma_{xy}b. \\
\end{split}
\end{align}\]</span></p>
</div>
<p>Die Varianz der Zufallsvariable <span class="math inline">\(a^Tx\)</span> ergibt sich also als die “quadrierte” Linearkombination von <span class="math inline">\(\Sigma_{xx}\)</span> und die Varianz der Zufallsvariable <span class="math inline">\(b^Ty\)</span> ergibt sich als die “quadrierte” Linearkombination von <span class="math inline">\(\Sigma_{yy}\)</span>. Die Korrelation der Zufallsvariablen <span class="math inline">\(a^Tx\)</span> und <span class="math inline">\(b^Ty\)</span> schließlich ergibt sich “quadrierte” Linearkombination von <span class="math inline">\(\Sigma_{xy}\)</span>.</p>
</section>
<section id="sec-modellformulierung-kka" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="sec-modellformulierung-kka"><span class="header-section-number">39.3</span> Modellformulierung</h2>
<p>Mit den beiden in <a href="#sec-mathematischer-hintergrund" class="quarto-xref"><span>Kapitel 39.2</span></a> diskutierten Theoremen ist es nun möglich, die Begriffe der <em>kanonischen Koeffezientenvektoren</em>, der <em>kanonischen Variate</em>, und schließlich der <em>kanonischen Korrelationen</em> zu definieren.</p>
<div id="def-kanonische-koeffizientenvektoren-variate-korrelationen" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 39.1 (Kanonische Koeffizientenvektoren, Variate, Korrelationen)</strong></span> &nbsp;</p>
Es seien <span class="math display">\[\begin{equation}
z = \begin{pmatrix} x \\ y \end{pmatrix}
\mbox{ mit }
\mathbb{E}(z) := 0_m
\mbox{ und }
\mathbb{C}(z) :=
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy} \\
\end{pmatrix}
\in \mathbb{R}^{m \times m}
\end{equation}\]</span> ein <span class="math inline">\(m\)</span>-dimensionaler partitionierter Zufallsvektor sowie sein Erwartungswert und seine Kovarianzmatrix, respektive. Weiterhin sei <span class="math display">\[\begin{equation}
K := \Sigma_{xx}^{-1/2}\Sigma_{xy}\Sigma_{yy}^{-1/2} \in \mathbb{R}^{m_x \times m_y}
\end{equation}\]</span> mit der Singulärwertzerlegung <span class="math display">\[\begin{equation}
K = A \Lambda B^T,
\end{equation}\]</span> wobei <span class="math display">\[\begin{equation}
A       := \begin{pmatrix} \alpha_1 &amp; \cdots &amp; \alpha_k \end{pmatrix} \in \mathbb{R}^{m_x \times m_y}
\mbox{ und }
B       := \begin{pmatrix} \beta_1  &amp; \cdots &amp;  \beta_k \end{pmatrix} \in \mathbb{R}^{m_y \times m_y}
\end{equation}\]</span> die orthogonalen Matrix der Eigenvektoren von <span class="math inline">\(KK^T\)</span> und die orthogonale Matrix der Eigenvektoren von <span class="math inline">\(K^TK\)</span>, respektive, bezeichnen und <span class="math display">\[\begin{equation}
\Lambda := \mbox{diag}\left(\lambda^{1/2}_1,...,\lambda_k^{1/2}\right) \in \mathbb{R}^{m_y \times m_y},
\end{equation}\]</span> die Diagonalmatrix der Quadratwurzeln der zugehörigen absteigend geordneten Eigenwerte bezeichnet. Schließlich seien für <span class="math inline">\(i = 1,...,k\)</span> <span class="math display">\[\begin{equation}
a_i := \Sigma_{xx}^{-1/2}\alpha_i  \in \mathbb{R}^{m_x} \mbox{ und } b_i := \Sigma_{yy}^{-1/2}\beta_i \in \mathbb{R}^{m_y}.
\end{equation}\]</span> Dann heißen für <span class="math inline">\(i = 1,...,k\)</span>
</div>
<p>Ihre Bedeutsamkeit erlangen diese Begriffe durch ihre Eigenschaften, die wir im folgenden Theorem zusammenfassen.</p>
<div id="thm-eigenschaften-kanonischer-korrelationen-und-variaten" class="theorem">
<p><span class="theorem-title"><strong>Theorem 39.3 (Eigenschaften kanonischer Korrelationen und Variaten)</strong></span> Es seien <span class="math display">\[\begin{equation}
z = \begin{pmatrix} x \\ y \end{pmatrix}
\mbox{ mit }
\mathbb{E}(z) := 0_m
\mbox{ und }
\mathbb{C}(z) :=
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy} \\
\end{pmatrix}
\in \mathbb{R}^{m \times m}
\end{equation}\]</span> ein <span class="math inline">\(m\)</span>-dimensionaler partitionierter Zufallsvektor sowie sein Erwartungswert und seine Kovarianzmatrix, respektive. Weiterhin seien für <span class="math inline">\(i = 1,...,k\)</span> die kanonischen Koeffizientenvektoren <span class="math inline">\(a_i, b_i\)</span>, die kanonischen Variaten <span class="math inline">\(\xi,\upsilon_i\)</span> und die kanonischen Korrelationen <span class="math inline">\(\rho_i\)</span> definiert wie oben. Dann gilt, dass für <span class="math inline">\(1 \le r \le k\)</span> das Maximum des <span class="math inline">\(r\)</span>ten restringierten Optimierungsproblems <span class="math display">\[\begin{equation}
\phi_r = \max_{a,b} a^T\Sigma_{xy}b
\end{equation}\]</span> unter den Nebenbedingungen <span class="math display">\[\begin{equation}
a^T\Sigma_{xx}a   = 1,
\quad
b^T\Sigma_{yy}b   = 1,
\quad
a_i^T\Sigma_{xx}a = 0 \mbox{ für } i = 1,...,r-1
\end{equation}\]</span> (1) den Wert <span class="math inline">\(\phi_r = \rho_r\)</span> hat und (2) bei <span class="math inline">\(a = a_r\)</span> und <span class="math inline">\(b = b_r\)</span> angenommen wird.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Beweis</em>. </span>Wir betrachten das restringierte Optimierungsproblem <span class="math display">\[\begin{equation}
\phi_r^2 = \max_{a,b} \left(a^T\Sigma_{xy}b\right)^2\,
\mbox{ u.d.N. }
a^T\Sigma_{xx}a   = 1,\,
b^T\Sigma_{yy}b   = 1,\,
a_i^T\Sigma_{xx}a = 0, i = 1,...,r-1
\end{equation}\]</span> Wir folgen <span class="citation" data-cites="mardia1979">Mardia et al. (<a href="#ref-mardia1979" role="doc-biblioref">1979</a>)</span>, S. 284 und gehen schrittweise vor, d.h. wir lösen das restringierte Optimierungsproblem <span class="math display">\[\begin{equation}
\phi_r^2 = \max_{a} \left(\max_{b} \left(a^T\Sigma_{xy}b\right)^2 \mbox{ u.d.N.} b^T\Sigma_{yy}b   = 1\right)
\mbox{ u.d.N. } a^T\Sigma_{xx}a   = 1,\, a_i^T\Sigma_{xy}a = 0,  i = 1,...,r-1
\end{equation}\]</span> von innen nach außen.</p>
<p>Schritt (1)</p>
<p>Wir wählen wir zunächst ein festes <span class="math inline">\(a \in \mathbb{R}^m\)</span> und betrachten das restringierte Optimierungsproblem <span class="math display">\[\begin{equation}
\max_{b} \left(a^T\Sigma_{xy}b\right)^2
\mbox{ u.d.N. }
b^T\Sigma_{yy}b   = 1
\end{equation}\]</span> Dieses Optimierungsproblem kann geschrieben werden als <span class="math display">\[\begin{equation}\label{eq:kka_opt_1}
\max_{b} b^T\Sigma_{yx}aa^T\Sigma_{xy}b
\mbox{ u.d.N. }
b^T\Sigma_{yy}b = 1,
\end{equation}\]</span> weil gilt, dass <span class="math display">\[\begin{equation}
\left(a^T\Sigma_{xy}b\right)^2
= \left(a^T\Sigma_{xy}b\right)\left(a^T\Sigma_{xy}b\right)
= \left(a^T\Sigma_{xy}b\right)^T a^T\Sigma_{xy}b
= b^T\Sigma_{yx}aa^T\Sigma_{xy}b.
\end{equation}\]</span> Das Optimierungsproblem <span class="math inline">\(\eqref{eq:kka_opt_1}\)</span> kann nun mithilfe des Theorems zur Maximierung quadratischer Formen mit Nebenbedingen gelöst werden. Im Sinne dieses Theorems setzen wir dazu <span class="math display">\[\begin{equation}
A := \Sigma_{yx}aa^T\Sigma_{xy} \mbox{ und } B := \Sigma_{yy}.
\end{equation}\]</span> Dann hat <span class="math inline">\(\eqref{eq:kka_opt_1}\)</span> die Form <span class="math display">\[\begin{equation}\label{eq:kka_opt_2}
\max_{b} b^TAb
\mbox{ unter der Nebenbedingung }
b^TBb = 1,
\end{equation}\]</span> Das Maximum von <span class="math inline">\(\eqref{eq:kka_opt_2}\)</span> entspricht nach dem Theorem zur Maximierung quadratischer Formen mit Nebenbedingungen dem größten Eigenwert von <span class="math display">\[\begin{equation}
B^{-1}A = \Sigma_{yy}^{-1}\Sigma_{yx}aa^T\Sigma_{xy}
\end{equation}\]</span> Der größte Eigenwert von <span class="math inline">\(\Sigma_{yy}^{-1}\Sigma_{yx}aa^T\Sigma_{xy}\)</span> wiederum kann mithilfe des Theorems zum Eigenwert und Eigenvektor eines Matrixvektorprodukts bestimmt werden. Im Sinne dieses Theorems setzen wir dazu <span class="math display">\[\begin{equation}
A := \Sigma_{yy}^{-1}\Sigma_{yx},\quad b := a,\quad B := \Sigma_{xy}
\end{equation}\]</span> und erhalten für den betreffenden Eigenwert <span class="math display">\[\begin{equation}
\lambda_a = b^TBAa = a^T\Sigma_{xy}\Sigma_{yy}^{-1}\Sigma_{yx}a.
\end{equation}\]</span> als Lösung (Maximum) des restringierten Optimierungsproblems <span class="math display">\[\begin{equation}
\max_{b} \left(a^T\Sigma_{xy}b\right)^2 \mbox{ u.d.N. } b^T\Sigma_{yy}b = 1
\end{equation}\]</span></p>
<p>Schritt (2)</p>
<p>Basierend auf Schritt (1) verbleibt die Lösung des restringierten Optimierungsproblem <span class="math display">\[\begin{equation}\label{eq:kka_opt_3}
\phi_r^2 = \max_{a} a^T\Sigma_{xy}\Sigma_{yy}^{-1}\Sigma_{yx}a
\mbox{ u.d.N. }
a^T\Sigma_{xx}a   = 1,\,
a_i^T\Sigma_{xx}a = 0,  i = 1,...,r-1
\end{equation}\]</span> Dazu halten wir zunächst fest, dass <span class="math inline">\(\eqref{eq:kka_opt_3}\)</span> mit den Definitionen von <span class="math inline">\(\alpha_i\)</span> und <span class="math inline">\(K\)</span> in der Definition der Kanonischen Koeffizientenvektoren, Variaten, und Korrelationen geschrieben werden kann als <span class="math display">\[\begin{equation}\label{eq:kka_opt_4}
\phi_r^2 = \max_{\alpha} \alpha^T KK^T \alpha
\mbox{ u.d.N. }
\alpha^T \alpha   = 1,\,
\alpha_i^T\alpha  = 0,  i = 1,...,r-1,
\end{equation}\]</span> denn <span class="math display">\[\begin{align}
\begin{split}
\phi_r^2 &amp; = \max_{a} a^T\Sigma_{xy}\Sigma_{yy}^{-1}\Sigma_{yx}a
\mbox{ u.d.N. }
a^T\Sigma_{xx}a   = 1,
a_i^T\Sigma_{xx}a = 0 \Leftrightarrow
\\
\phi_r^2 &amp; = \max_{\alpha} a^T\Sigma_{xy}\Sigma_{yy}^{-1}\Sigma_{yx}a
\mbox{ u.d.N. }
\alpha^T\Sigma_{xx}^{-1/2}\Sigma_{xx}\Sigma_{xx}^{-1/2}\alpha = 1,
\alpha^T_i\Sigma_{xx}^{-1/2}\Sigma_{xx}\Sigma_{xx}^{-1/2}\alpha = 0
\\
\phi_r^2 &amp; = \max_{\alpha} \alpha^T\Sigma_{xx}^{-1/2}\Sigma_{xy}\Sigma_{yy}^{-1}\Sigma_{yx}\Sigma_{xx}^{-1/2}\alpha
\mbox{ u.d.N. }
\alpha^T\alpha = 1,
\alpha^T_i\alpha = 0
\\
\phi_r^2 &amp; = \max_{\alpha} \alpha^T\Sigma_{xx}^{-1/2}\Sigma_{xy}\Sigma_{yy}^{-1/2}\Sigma_{yy}^{-1/2}\Sigma_{yx}\Sigma_{xx}^{-1/2}\alpha
\mbox{ u.d.N. }
\alpha^T\alpha = 1,
\alpha^T_i\alpha = 0
\\
\phi_r^2 &amp; = \max_{\alpha} \alpha^TKK^T\alpha
\mbox{ u.d.N. }
\alpha^T\alpha = 1,
\alpha^T_i\alpha = 0
\end{split}
\end{align}\]</span></p>
<p>Dabei sind nach der betreffenden Definition die <span class="math inline">\(\alpha_i\)</span> die Eigenvektoren von <span class="math inline">\(KK^T\)</span> mit den <span class="math inline">\(i = 1,...,r-1\)</span> größten Eigenwerten. Nach dem Theorem zur Maximierung quadratischer Formen mit Nebenbedingungen ist die Lösung von <span class="math inline">\(\eqref{eq:kka_opt_4}\)</span> der größte Eigenwert von <span class="math inline">\(KK^T\)</span> mit seinem assoziierten Eigenvektor. Die Nebenbedingung <span class="math inline">\(\alpha_i^T\alpha = 0\)</span> schränkt diese Wahl auf den <span class="math inline">\(r\)</span>t-größten Eigenwert und seinen assoziierten Eigenvektor <span class="math inline">\(\alpha_r\)</span> ein. Mit der Definition von Eigenwerten und Eigenvektoren gilt also <span class="math display">\[\begin{equation}
\phi_r^2 = \alpha_r^T KK^T \alpha_r = \alpha_r^T \lambda_r \alpha_r = \lambda_r \alpha_r^T\alpha_r = \lambda_r.
\end{equation}\]</span> Wir haben also gezeigt, dass das restringierte Optimierungsproblem des Theorems den Maximumwert <span class="math inline">\(\phi_r = \lambda_r^{1/2}\)</span> hat. Es bleibt zu zeigen, dass dieser Maximumwert für <span class="math inline">\(a_r\)</span> und <span class="math inline">\(b_r\)</span> angenommen wird.</p>
<p>Schritt (3)</p>
<p>Einsetzen von <span class="math inline">\(a_r\)</span> und <span class="math inline">\(b_r\)</span> in <span class="math inline">\(a^T\Sigma_{xy}b\)</span> ergibt mit <span class="math display">\[\begin{equation}
K = A\Lambda B^T
\Leftrightarrow KB = A\Lambda B^TB
\Leftrightarrow KB = A\Lambda
\Leftrightarrow K\beta_r = \alpha_r\lambda_r^{1/2}
\end{equation}\]</span> dass <span class="math display">\[\begin{equation}
a^T_r\Sigma_{xy}b_r
= \alpha_r^T\Sigma_{xx}^{-1/2}\Sigma_{xy}\Sigma_{yy}^{-1/2}\beta_r
= \alpha_r^TK\beta_r
= \alpha_r^T\alpha_r\lambda_r^{1/2}
= \rho_r
\end{equation}\]</span> Also nimmt <span class="math inline">\(a^T\Sigma_{xy}b\)</span> bei <span class="math inline">\(a_r\)</span> und <span class="math inline">\(b_r\)</span> seinen restringierten Maximalwert <span class="math inline">\(\lambda_r\)</span> an.</p>
</div>
<p><span class="math inline">\(\phi_1\)</span> ist also die größtmögliche Korrelation von <span class="math display">\[\begin{equation}
\xi = a^Tx \mbox{ und } \upsilon = b^Ty
\end{equation}\]</span> unter den Nebenbedingungen <span class="math display">\[\begin{equation}
\mathbb{V}(\xi) = 1 \mbox{ und } \mathbb{V}(\upsilon) = 1
\end{equation}\]</span> und erfüllt damit die Forderungen an <em>die</em> kanonische Korrelatione. <span class="math inline">\(\phi_r\)</span> mit <span class="math inline">\(r &gt; 1\)</span> ist die größtmögliche Korrelation von <span class="math display">\[\begin{equation}
\xi = a^Tx \mbox{ und } \upsilon = b^Ty
\end{equation}\]</span> unter den Nebenbedingungen <span class="math display">\[\begin{equation}
\mathbb{V}(\xi)   = 1,
\mathbb{V}(\upsilon)  = 1
\mbox{ und } \mathbb{C}(\xi_i,\xi) = 0 \mbox{ für die kanonischen Variate } \xi_i \mbox{ mit } i = 1,...,r-1.
\end{equation}\]</span></p>
<section id="simulationsbeispiel" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="simulationsbeispiel">Simulationsbeispiel</h3>
<p>Wir betrachten das Beispiel (vgl. <span class="citation" data-cites="uurtio2018">Uurtio et al. (<a href="#ref-uurtio2018" role="doc-biblioref">2018</a>)</span>) <span class="math display">\[\begin{equation}
p(x) = N(x;0_4,I_4) \mbox{ und } p(y|x) = N(y; Lx, G)
\end{equation}\]</span> mit <span class="math display">\[\begin{equation}
L := \begin{pmatrix} 0.0 &amp; 0.0 &amp; 1.0 &amp; 0.0 \\ 1.0 &amp; 0.0 &amp; 0.0 &amp; 0.0 \\ 0.0 &amp; 0.0 &amp; 0.0 &amp; -1.0 \end{pmatrix}
\mbox{ und }
G := \begin{pmatrix} 0.2 &amp; 0.0 &amp; 0.0 \\ 0.0 &amp; 0.4 &amp; 0.0 \\ 0.0 &amp; 0.0 &amp; 0.3 \end{pmatrix}
\end{equation}\]</span> Hier gilt offenbar <span class="math inline">\(m_x = 4, m_y = 3, m = 7\)</span> und <span class="math display">\[\begin{align}
\begin{split}
y_1 &amp; = \,\,\,\, x_3 + \varepsilon_1 \\
y_2 &amp; = \,\,\,\, x_1 + \varepsilon_2 \\
y_3 &amp; =        - x_4 + \varepsilon_3 \\
\end{split}
\end{align}\]</span> mit <span class="math display">\[\begin{equation}
x_1 \sim N(0,1), x_3 \sim N(0,1), x_4 \sim N(0,1)
\end{equation}\]</span> und <span class="math display">\[\begin{equation}
\varepsilon_1 \sim N(0,0.2), \varepsilon_2 \sim N(0,0.4), \varepsilon_3 \sim N(0,0.3)
\end{equation}\]</span> Mit dem Theorem zu gemeinsamen Normalverteilungen (vgl. <span class="quarto-unresolved-ref">?sec-normalverteilungen</span>) ergibt sich, dass <span class="math display">\[\begin{equation}
\begin{pmatrix} x \\ y \end{pmatrix}
\sim N(0_7,\Sigma)
\end{equation}\]</span> mit <span class="math display">\[\begin{equation}
\Sigma
=
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy}
\end{pmatrix},
\end{equation}\]</span> wobei <span class="math display">\[\begin{equation}
\Sigma_{xx} = I_4, \quad
\Sigma_{xy} = L^T, \quad
\Sigma_{yx} = L \mbox{ und }
\Sigma_{yy} = G + LL^T.
\end{equation}\]</span> Explizit ergibt sich also <span class="math display">\[\begin{equation}
\Sigma
=
\begin{pmatrix}
I_4 &amp;  L^T \\
L   &amp;  G + LL^T
\end{pmatrix}
=
\begin{pmatrix}
1.0 &amp; 0.0 &amp; 0.0 &amp;  0.0 &amp; 0.0 &amp; 1.0 &amp;  0.0 \\
0.0 &amp; 1.0 &amp; 0.0 &amp;  0.0 &amp; 0.0 &amp; 0.0 &amp;  0.0 \\
0.0 &amp; 0.0 &amp; 1.0 &amp;  0.0 &amp; 1.0 &amp; 0.0 &amp;  0.0 \\
0.0 &amp; 0.0 &amp; 0.0 &amp;  1.0 &amp; 0.0 &amp; 0.0 &amp; -1.0 \\
0.0 &amp; 0.0 &amp; 1.0 &amp;  0.0 &amp; 1.2 &amp; 0.0 &amp;  0.0 \\
1.0 &amp; 0.0 &amp; 0.0 &amp;  0.0 &amp; 0.0 &amp; 1.4 &amp;  0.0 \\
0.0 &amp; 0.0 &amp; 0.0 &amp; -1.0 &amp; 0.0 &amp; 0.0 &amp;  1.3 \\
\end{pmatrix}
\end{equation}\]</span></p>
<p>Folgender <strong>R</strong> Code definiert zunächst den Kovarianzmatrixparameter der gemeinsamen Verteilung von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># R Pakete für Matrizenrechnung</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(expm)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Modellparameter</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>L <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>             <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb1-7"><a href="#cb1-7"></a>             <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb1-8"><a href="#cb1-8"></a>           <span class="at">nrow  =</span> <span class="dv">3</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>           <span class="at">byrow =</span> T)</span>
<span id="cb1-10"><a href="#cb1-10"></a>G <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>))</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># Kovarianzmatrixpartition</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>Sigma_xx <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">4</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a>Sigma_xy <span class="ot">=</span> <span class="fu">t</span>(L)</span>
<span id="cb1-15"><a href="#cb1-15"></a>Sigma_yx <span class="ot">=</span> L</span>
<span id="cb1-16"><a href="#cb1-16"></a>Sigma_yy <span class="ot">=</span> G <span class="sc">+</span> L <span class="sc">%*%</span> <span class="fu">t</span>(L)</span>
<span id="cb1-17"><a href="#cb1-17"></a>Sigma    <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(Sigma_xx, Sigma_xy), <span class="fu">cbind</span>(Sigma_yx, Sigma_yy))</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">print</span>(Sigma)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    0    0    0  0.0  1.0  0.0
[2,]    0    1    0    0  0.0  0.0  0.0
[3,]    0    0    1    0  1.0  0.0  0.0
[4,]    0    0    0    1  0.0  0.0 -1.0
[5,]    0    0    1    0  1.2  0.0  0.0
[6,]    1    0    0    0  0.0  1.4  0.0
[7,]    0    0    0   -1  0.0  0.0  1.3</code></pre>
</div>
</div>
<p>Anhand von <a href="#def-kanonische-koeffizientenvektoren-variate-korrelationen" class="quarto-xref">Definition&nbsp;<span>39.1</span></a> bestimmt folgender <strong>R</strong> Code dann basierend auf obigem Kovarianzmatrixparameter die kanonischen Korrelationen und kanonischen Koeffizientenvektoren.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Evaluation der iten kanonischen Koeffizientenvektoren und Korrelationen</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>K      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_xx)) <span class="sc">%*%</span> Sigma_xy <span class="sc">%*%</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_yy))         <span class="co"># K</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>ALB    <span class="ot">=</span> <span class="fu">svd</span>(K)                                                                 <span class="co"># K = A\LambdaV</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>A      <span class="ot">=</span> ALB<span class="sc">$</span>u                                                                  <span class="co"># A</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>Lambda <span class="ot">=</span> ALB<span class="sc">$</span>d                                                                  <span class="co"># Lambda</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>B      <span class="ot">=</span> ALB<span class="sc">$</span>v                                                                  <span class="co"># B</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>rho    <span class="ot">=</span> Lambda                                                                 <span class="co"># \rho_i = \lambda_i^{1/2}</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>a      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_xx)) <span class="sc">%*%</span> A                                           <span class="co"># a_i = \Sigma_{xx}^{-1/2}\alpha_i</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>b      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_yy)) <span class="sc">%*%</span> B                                           <span class="co"># b_i = \Sigma_{yy}^{-1/2}\beta_i</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>rho_1 =  0.9128709 , a_1^T = ( 0 0 -1 0 ), b_1^T = ( -0.9128709 0 0 ) 
rho_2 =  0.877058  , a_2^T = ( 0 0 0 1 ) , b_2^T = ( 0 0 -0.877058 ) 
rho_3 =  0.8451543 , a_3^T = ( -1 0 0 0 ), b_3^T = ( 0 -0.8451543 0 )</code></pre>
</div>
</div>
</section>
</section>
<section id="sec-modellschaetzung-kka" class="level2" data-number="39.4">
<h2 data-number="39.4" class="anchored" data-anchor-id="sec-modellschaetzung-kka"><span class="header-section-number">39.4</span> Modellschätzung</h2>
<p>Zur Schätzung einer kanonischen Korrelationsanalyse wird die Kovarianzmatrix <span class="math inline">\(\mathbb{C}(z)\)</span> des gemeinsamen Zufallsvektors <span class="math inline">\(z\)</span> von Prädiktoren und Kriterien durch ihr Stichprobenäquivalent <span class="math inline">\(C\)</span> ersetzt. Dies ist die Aussage folgender Definition.</p>
<div id="def-schätzer-der-kanonischen-korrelationsanalyse" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 39.2 (Schätzer der kanonischen Korrelationsanalyse)</strong></span> Für <span class="math inline">\(i = 1,...,n\)</span> seien <span class="math display">\[\begin{equation}
z_i = \begin{pmatrix} x_i \\ y_i \end{pmatrix}
\mbox{ mit }
\mathbb{E}(z_i) := 0_m
\mbox{ und }
\mathbb{C}(z_i) :=
\begin{pmatrix}
\Sigma_{xx} &amp; \Sigma_{xy} \\
\Sigma_{yx} &amp; \Sigma_{yy} \\
\end{pmatrix}
\in \mathbb{R}^{m \times m}
\end{equation}\]</span> unabhängig und identisch verteilte <span class="math inline">\(m\)</span>-dimensionale partitionierte Zufallsvektoren sowie ihr Erwartungswert und ihre Kovarianzmatrix, respektive, und <span class="math display">\[\begin{equation}
C :=
\begin{pmatrix}
C_{xx} &amp; C_{xy} \\
C_{yx} &amp; C_{yy} \\
\end{pmatrix}
\in \mathbb{R}^{m \times m}
\end{equation}\]</span> sei ihre Stichprobenkovarianzmatrix. Dann sind für <span class="math inline">\(i = 1,...,k := \min \{m_x,m_y\}\)</span> <span class="math display">\[\begin{equation}
\hat{a}_i := C_{xx}^{-1/2}\hat{\alpha}_i \in \mathbb{R}^{m_x}, \quad
\hat{b}_i := C_{yy}^{-1/2}\hat{\beta}_i \in \mathbb{R}^{m_y} \mbox{ und }
\hat{\rho}_i := \hat{\lambda}_i^{1/2}
\end{equation}\]</span> Schätzer der <span class="math inline">\(i\)</span>ten kanonischen Koeffizientenvektoren und kanonischen Korrelationen, respektive. Dabei sind mit <span class="math display">\[\begin{equation}
\hat{K} := C_{xx}^{-1/2}C_{xy}C_{yy}^{-1/2} \in \mathbb{R}^{m_x \times m_y}
\end{equation}\]</span> <span class="math inline">\(\hat{\alpha}_i\)</span> und <span class="math inline">\(\hat{\lambda}_i\)</span> der <span class="math inline">\(i\)</span>te Eigenvektor und sein zugehöriger Eigenwert von <span class="math inline">\(\hat{K}\hat{K}^T\)</span> und <span class="math inline">\(\hat{\beta}_i\)</span> der entsprechende Eigenkvektor von <span class="math inline">\(\hat{K}^T\hat{K}\)</span>.</p>
</div>
<p>Wir verzichten auf eine Diskussion der Güte dieser Schätzung.</p>
<section id="simulationsbeispiel-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="simulationsbeispiel-1">Simulationsbeispiel</h3>
<p>Mithilfe folgenden <strong>R</strong> Codes verdeutlichen wir uns die Schätzung kanonischer Korrelationen und Koeffizientenvektoren in dem oben betrachteten Beispiel. Dazu generieren wir Realisierungen der Prädiktoren und Kriterien bei Stichprobenumfängen zwischen <span class="math inline">\(n = 100\)</span> und <span class="math inline">\(n = 1000\)</span>. <a href="#fig-modellschätzung-1" class="quarto-xref">Abbildung&nbsp;<span>39.1</span></a> visualisiert die wahren, aber unbekannten, kanonischen Korrelationen <span class="math inline">\(\rho_1,\rho_2,\rho_3\)</span> und ihre für jede Simulation basierend auf der Stichprobenkovarianzmatrix des realisierten Datensatzes geschätztes Äquivalente <span class="math inline">\(\hat{\rho}_1, \hat{\rho}_2,\hat{\rho}_3\)</span>. Die Variabilität der Schätzung nimmt mit zunehmenden Stichprobenumfang ab. <a href="#fig-modellschätzung-2" class="quarto-xref">Abbildung&nbsp;<span>39.2</span></a> visualisiert die Absolutwerte des wahren, aber unbekannten, ersten kanonischen Koeffizientenvektors <span class="math inline">\(a_1\)</span> sowie ihre entsprechenden Schätzungen als <span class="math inline">\(\hat{a}_1\)</span>. Auch hier nimmt die Variabilität der Schätzung mit zunehmenden Stichprobenumfang ab. Allerdings ist zu beachten, dass es sich hierbei um die Absolutwerte des kanonischen Koeffizientenvektors handelt und das Vorzeichen abhängig von der Schätzung auch im Widerspruch zum wahren, aber unbekannten, Wert des kanonischen Koeffizientenvektors stehen kann.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># R Pakete</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(MASS)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">library</span>(expm)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Modellparameter</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>m_x      <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>m_y      <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>k        <span class="ot">=</span> <span class="fu">min</span>(m_x,m_y)</span>
<span id="cb5-9"><a href="#cb5-9"></a>L        <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">byrow =</span> <span class="dv">3</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a>G        <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>))</span>
<span id="cb5-11"><a href="#cb5-11"></a>Sigma_xx <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">4</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>Sigma_xy <span class="ot">=</span> <span class="fu">t</span>(L)</span>
<span id="cb5-13"><a href="#cb5-13"></a>Sigma_yx <span class="ot">=</span> L</span>
<span id="cb5-14"><a href="#cb5-14"></a>Sigma_yy <span class="ot">=</span> G <span class="sc">+</span> L <span class="sc">%*%</span> <span class="fu">t</span>(L)</span>
<span id="cb5-15"><a href="#cb5-15"></a>Sigma    <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(Sigma_xx, Sigma_xy), <span class="fu">cbind</span>(Sigma_yx, Sigma_yy))</span>
<span id="cb5-16"><a href="#cb5-16"></a>K        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_xx)) <span class="sc">%*%</span> Sigma_xy <span class="sc">%*%</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_yy))</span>
<span id="cb5-17"><a href="#cb5-17"></a>ALB      <span class="ot">=</span> <span class="fu">svd</span>(K)</span>
<span id="cb5-18"><a href="#cb5-18"></a>A        <span class="ot">=</span> ALB<span class="sc">$</span>u</span>
<span id="cb5-19"><a href="#cb5-19"></a>Lambda   <span class="ot">=</span> ALB<span class="sc">$</span>d</span>
<span id="cb5-20"><a href="#cb5-20"></a>B        <span class="ot">=</span> ALB<span class="sc">$</span>v</span>
<span id="cb5-21"><a href="#cb5-21"></a>rho      <span class="ot">=</span> Lambda</span>
<span id="cb5-22"><a href="#cb5-22"></a>a        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_xx)) <span class="sc">%*%</span> A</span>
<span id="cb5-23"><a href="#cb5-23"></a>b        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(Sigma_yy)) <span class="sc">%*%</span> B</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Simulationen</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>n       <span class="ot">=</span> <span class="fl">1e1</span><span class="sc">:</span><span class="fl">1e3</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>rho_hat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NaN</span>, <span class="fu">length</span>(n)<span class="sc">*</span>k)  , <span class="at">nrow =</span> k)</span>
<span id="cb6-4"><a href="#cb6-4"></a>a_1_hat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="cn">NaN</span>, <span class="fu">length</span>(n)<span class="sc">*</span>m_x), <span class="at">nrow =</span> m_x)</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="co"># Datengeneration</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>    Y          <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">mvrnorm</span>(n[i],<span class="fu">rep</span>(<span class="dv">0</span>, m_x<span class="sc">+</span>m_y),Sigma))</span>
<span id="cb6-9"><a href="#cb6-9"></a>    I_n        <span class="ot">=</span> <span class="fu">diag</span>(n[i])</span>
<span id="cb6-10"><a href="#cb6-10"></a>    J_n        <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,n[i]<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> n[i])</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="co"># Stichprobenkovarianzmatrixpartition</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    C          <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(n[i]<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(Y <span class="sc">%*%</span> (I_n<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>n[i])<span class="sc">*</span>J_n) <span class="sc">%*%</span> <span class="fu">t</span>(Y))</span>
<span id="cb6-14"><a href="#cb6-14"></a>    C_xx       <span class="ot">=</span> C[<span class="dv">1</span><span class="sc">:</span>m_x,<span class="dv">1</span><span class="sc">:</span>m_x]</span>
<span id="cb6-15"><a href="#cb6-15"></a>    C_xy       <span class="ot">=</span> C[<span class="dv">1</span><span class="sc">:</span>m_x,(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y)]</span>
<span id="cb6-16"><a href="#cb6-16"></a>    C_yx       <span class="ot">=</span> C[(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y),<span class="dv">1</span><span class="sc">:</span>m_x]</span>
<span id="cb6-17"><a href="#cb6-17"></a>    C_yy       <span class="ot">=</span> C[(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y),(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y)]</span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a>    <span class="co"># Kanonische Korrelationsanalyse</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>    K_hat        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_xx)) <span class="sc">%*%</span> C_xy <span class="sc">%*%</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_yy))</span>
<span id="cb6-21"><a href="#cb6-21"></a>    ALB_hat      <span class="ot">=</span> <span class="fu">svd</span>(K_hat)</span>
<span id="cb6-22"><a href="#cb6-22"></a>    A_hat        <span class="ot">=</span> ALB_hat<span class="sc">$</span>u</span>
<span id="cb6-23"><a href="#cb6-23"></a>    Lambda_hat   <span class="ot">=</span> ALB_hat<span class="sc">$</span>d</span>
<span id="cb6-24"><a href="#cb6-24"></a>    B_hat        <span class="ot">=</span> ALB_hat<span class="sc">$</span>v</span>
<span id="cb6-25"><a href="#cb6-25"></a>    a_hat        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_xx)) <span class="sc">%*%</span> A_hat</span>
<span id="cb6-26"><a href="#cb6-26"></a>    b_hat        <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_yy)) <span class="sc">%*%</span> B_hat</span>
<span id="cb6-27"><a href="#cb6-27"></a>    rho_hat[,i]  <span class="ot">=</span> <span class="fu">as.matrix</span>(Lambda_hat)</span>
<span id="cb6-28"><a href="#cb6-28"></a>    a_1_hat[,i]  <span class="ot">=</span> a_hat[,<span class="dv">1</span>]</span>
<span id="cb6-29"><a href="#cb6-29"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-modellschätzung-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-modellschätzung-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./_figures/504-modellschätzung-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-modellschätzung-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.1: Schätzung kanonischer Korrelationen im Simulationsbeispiel
</figcaption>
</figure>
</div>
<div id="fig-modellschätzung-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-modellschätzung-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./_figures/504-modellschätzung-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-modellschätzung-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.2: Schätzung der Absolutwerte des ersten kanonischen Koeffizientenvektors im Simulationsbeispiel
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-anwendungsbeispiel-kka" class="level2" data-number="39.5">
<h2 data-number="39.5" class="anchored" data-anchor-id="sec-anwendungsbeispiel-kka"><span class="header-section-number">39.5</span> Anwendungsbeispiel</h2>
<p>Zuletzt wollen wir die konkrete Berechnung einer kanonischen Korrelationsanalyse im Kontext des in <a href="#sec-anwendungsszenario" class="quarto-xref"><span>Kapitel 39.1</span></a> diskutierten Anwendungsbeispiels demonstrieren. Folgender <strong>R</strong> Code implementiert die Berechnung der kanonischen Korrelationen und kanonischen Koeffizientenvektoren für diesen Datensatz.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># R Paket </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">library</span>(expm)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Datenpräprozessierung</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>fname      <span class="ot">=</span> <span class="st">"./_data/504-kanonische-korrelationsanalyse.csv"</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>D          <span class="ot">=</span> <span class="fu">read.table</span>(fname, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>x          <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(D<span class="sc">$</span>DUR, D<span class="sc">$</span>EXP))</span>
<span id="cb7-8"><a href="#cb7-8"></a>y          <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(D<span class="sc">$</span>dBDI, D<span class="sc">$</span>dGLU))</span>
<span id="cb7-9"><a href="#cb7-9"></a>n          <span class="ot">=</span> <span class="fu">nrow</span>(x)</span>
<span id="cb7-10"><a href="#cb7-10"></a>m_x        <span class="ot">=</span> <span class="fu">ncol</span>(x)</span>
<span id="cb7-11"><a href="#cb7-11"></a>m_y        <span class="ot">=</span> <span class="fu">ncol</span>(y)</span>
<span id="cb7-12"><a href="#cb7-12"></a>Y          <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">cbind</span>(x,y))</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co"># Stichprobenkovarianzmatrixpartition</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>I_n        <span class="ot">=</span> <span class="fu">diag</span>(n)</span>
<span id="cb7-16"><a href="#cb7-16"></a>J_n        <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>,n<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> n)</span>
<span id="cb7-17"><a href="#cb7-17"></a>C          <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">*</span>(Y <span class="sc">%*%</span> (I_n<span class="sc">-</span>(<span class="dv">1</span><span class="sc">/</span>n)<span class="sc">*</span>J_n) <span class="sc">%*%</span> <span class="fu">t</span>(Y))</span>
<span id="cb7-18"><a href="#cb7-18"></a>C_xx       <span class="ot">=</span> C[<span class="dv">1</span><span class="sc">:</span>m_x,<span class="dv">1</span><span class="sc">:</span>m_x]</span>
<span id="cb7-19"><a href="#cb7-19"></a>C_xy       <span class="ot">=</span> C[<span class="dv">1</span><span class="sc">:</span>m_x,(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y)]</span>
<span id="cb7-20"><a href="#cb7-20"></a>C_yx       <span class="ot">=</span> C[(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y),<span class="dv">1</span><span class="sc">:</span>m_x]</span>
<span id="cb7-21"><a href="#cb7-21"></a>C_yy       <span class="ot">=</span> C[(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y),(m_x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m_x<span class="sc">+</span>m_y)]</span>
<span id="cb7-22"><a href="#cb7-22"></a></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co"># Kanonische Korrelationsanalyse</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>K_hat      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_xx)) <span class="sc">%*%</span> C_xy <span class="sc">%*%</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_yy))</span>
<span id="cb7-25"><a href="#cb7-25"></a>ALB_hat    <span class="ot">=</span> <span class="fu">svd</span>(K_hat)</span>
<span id="cb7-26"><a href="#cb7-26"></a>A_hat      <span class="ot">=</span> ALB_hat<span class="sc">$</span>u</span>
<span id="cb7-27"><a href="#cb7-27"></a>Lambda_hat <span class="ot">=</span> ALB_hat<span class="sc">$</span>d</span>
<span id="cb7-28"><a href="#cb7-28"></a>B_hat      <span class="ot">=</span> ALB_hat<span class="sc">$</span>v</span>
<span id="cb7-29"><a href="#cb7-29"></a>a_hat      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_xx)) <span class="sc">%*%</span> A_hat</span>
<span id="cb7-30"><a href="#cb7-30"></a>b_hat      <span class="ot">=</span> <span class="fu">sqrtm</span>(<span class="fu">solve</span>(C_yy)) <span class="sc">%*%</span> B_hat</span>
<span id="cb7-31"><a href="#cb7-31"></a>rho_hat    <span class="ot">=</span> <span class="fu">as.matrix</span>(Lambda_hat)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>rho_hat_1 :  0.9950575 
a_hat_1   :  -0.1623409 -0.173979 
b_hat_1   :  -0.1554175 -0.05025419 
rho_hat_2 :  0.5010358 
a_hat_2   :  -0.06026274 0.3118808 
b_hat_2   :  -0.08128072 0.7773036</code></pre>
</div>
</div>
<p>Neben der Implementation mithilfe einer Singulärwertzerlegung bietet <strong>R</strong> auch eine direkte Bestimmung mithilfe der <code>cancor()</code> Funktion an. Folgender <strong>R</strong> Code demonstriert das entsprechende Vorgehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Datenpräprozessierung</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>fname      <span class="ot">=</span> <span class="st">"./_data/504-kanonische-korrelationsanalyse.csv"</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>D          <span class="ot">=</span> <span class="fu">read.table</span>(fname, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>x          <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(D<span class="sc">$</span>DUR, D<span class="sc">$</span>EXP))</span>
<span id="cb9-5"><a href="#cb9-5"></a>y          <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(D<span class="sc">$</span>dBDI, D<span class="sc">$</span>dGLU))</span>
<span id="cb9-6"><a href="#cb9-6"></a>cca        <span class="ot">=</span> <span class="fu">cancor</span>(x,y)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>rho_hat_1 :  0.9950575 
rho_hat_2 :  0.5010358</code></pre>
</div>
</div>
<p>Man findet also, dass die geschätzte maximale Korrelation einer Linearkombinationen der Prädiktorvariablen <code>DUR</code> und <code>EXP</code> mit einer Linearkombination der Kriterien <code>dBDI</code> und <code>dGLU</code> mit <span class="math inline">\(\hat{\rho}_1 = 0.99\)</span> sehr hoch ist. Man kann daraus schließen, dass in diesem Fall die Prädiktorvariablen gemeinschaftlich hoch mit den Kriterien assoziiert sind. Es ergeben sich hier insbesondere die Linearkombinationen <span class="math display">\[\begin{equation}
\xi = 0.16 \mbox{ DUR} + 0.17 \mbox{ EXP}
\mbox{ und }
\upsilon  = 0.15 \mbox{ dBDI} + 0.05 \mbox{ dGLU}
\end{equation}\]</span> als bester Prädiktor und als am besten prädizierbares Kriterium, respektive. Die Dauer der Psychotherapie und die Erfahrung der behandelnden Psychotherapeut:in scheinen, bei der aktuellen Datenskalierung zur bestmöglichen Prädiktion der Therapiegüte also in etwa gleichbedeutend, bei dem bestprädizierbarem Kriterium der Therapieeffizienz trägt bei der aktuellen Datenskalierung die BDI Score Reduktion etwas mehr bei als die Glukokortikoidplasmalevel Reduktion bei.</p>
</section>
<section id="literaturhinweise" class="level2" data-number="39.6">
<h2 data-number="39.6" class="anchored" data-anchor-id="literaturhinweise"><span class="header-section-number">39.6</span> Literaturhinweise</h2>
<p>Die kanonische Korrelationsanalyse geht zurück auf <span class="citation" data-cites="hotelling1935">Hotelling (<a href="#ref-hotelling1935" role="doc-biblioref">1935</a>)</span> und <span class="citation" data-cites="hotelling1936">Hotelling (<a href="#ref-hotelling1936" role="doc-biblioref">1936</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-anderson2003" class="csl-entry" role="listitem">
Anderson, T. W. (2003). <em>An Introduction to Multivariate Statistical Analysis</em> (3rd ed). <span>Wiley-Interscience</span>.
</div>
<div id="ref-hotelling1935" class="csl-entry" role="listitem">
Hotelling, H. (1935). The Most Predictable Criterion. <em>Journal of Educational Psychology</em>, <em>26</em>(2), 139–142. <a href="https://doi.org/10.1037/h0058165">https://doi.org/10.1037/h0058165</a>
</div>
<div id="ref-hotelling1936" class="csl-entry" role="listitem">
Hotelling, H. (1936). Relations <span>Between Two Sets</span> of <span>Variates</span>. <em>Biometrika</em>, <em>28</em>(3/4), 321. <a href="https://doi.org/10.2307/2333955">https://doi.org/10.2307/2333955</a>
</div>
<div id="ref-mardia1979" class="csl-entry" role="listitem">
Mardia, K. V., Kent, J. T., &amp; Bibby, J. M. (1979). <em>Multivariate Analysis</em>. <span>Academic Press</span>.
</div>
<div id="ref-uurtio2018" class="csl-entry" role="listitem">
Uurtio, V., Monteiro, J. M., Kandola, J., Shawe-Taylor, J., Fernandez-Reyes, D., &amp; Rousu, J. (2018). A <span>Tutorial</span> on <span>Canonical Correlation Methods</span>. <em>ACM Computing Surveys</em>, <em>50</em>(6), 1–33. <a href="https://doi.org/10.1145/3136624">https://doi.org/10.1145/3136624</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./503-Einfaktorielle-Varianzanalyse.html" class="pagination-link" aria-label="Einfaktorielle Varianzanalyse">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Einfaktorielle Varianzanalyse</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Referenzen.html" class="pagination-link" aria-label="Referenzen">
        <span class="nav-page-text">Referenzen</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/dirk-ostwald/dirk-ostwald.github.io/tree/gh-pages/edit/main/504-Kanonische-Korrelationsanalyse.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li></ul></div></div></div></footer></body></html>